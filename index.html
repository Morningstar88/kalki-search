<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Google Fonts Import. -->
  <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@100;200&display=swap" rel="stylesheet">
  <title>Kalki Search Engine</title>
  <!-- COMIT NOTES: Last commit a mess? Recommit Masonry Pinterrest Grid. TODO: Add toggle button.-->
  <style>
    /* Global Styles */
    * {
      box-sizing: border-box;
    }

    body {
      font-family: "Josefin Sans", sans-serif;
      font-weight: 200;
      background-color: #0a0a0a;
      color: #33ff99;
      margin: 0;
      padding: 0;
    }

    /* KALKI Title */
    .kalki-logo {
      font-size: 8em;
      color: #33ff99;
      text-shadow: 0 0 10px #33ff99, 0 0 20px #33ff99, 0 0 30px #33ff99;
      text-align: center;
      margin: 20px 0;
    }

    /* Search Box */
    .search-container {
      text-align: center;
      margin: 20px 0;
    }

    #search-box {
      width: 300px;
      padding: 10px;
      font-size: 1.2em;
      border: 2px solid #33ff99;
      border-radius: 25px 5px 25px 5px;
      background-color: #0a0a0a;
      color: #33ff99;
    }

    #search-box::placeholder {
      color: #80ffbf;
    }

    #search-button {
      padding: 10px 20px;
      font-size: 1.2em;
      background-color: #33ff99;
      color: #0a0a0a;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      margin-left: 10px;
      transition: background-color 0.3s ease;
    }

    #search-button:hover {
      background-color: #80ffbf;
    }

    /* RAM Results with Masonry Layout */
    .kalki-post-container {
      column-count: 3; /* Number of columns */
      column-gap: 20px;
    }

    .kalki-post {
      display: inline-block;
      width: 100%;
      margin-bottom: 20px;
      border: 1px solid #e1e8ed;
      border-radius: 4px;
      background-color: #222;
      overflow: hidden;
    }

    .kalki-post img {
      width: 100%;
      aspect-ratio: 16 / 9;
      object-fit: cover; /* Ensures images fit nicely */
    }

    .post-content {
      padding: 16px;
    }

    .post-title {
      font: 700 18px/1.4em system-ui, Roboto, Arial, sans-serif;
      color: #555;
      margin-top: 0;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .post-tag {
      display: inline-block;
      margin-right: 10px;
      margin-bottom: 10px;
      padding: 0 10px;
      color: #717171;
      border: 1px solid #9b9b9b;
      border-radius: 25px 5px 25px 5px;
      white-space: nowrap;
    }
  </style>
</head>
<body>
  <header>
    <h1 class="kalki-logo">KALKI</h1>
  </header>

  <div class="search-container">
    <input type="text" id="search-box" placeholder="Search Village...">
    <button id="search-button">Go</button>
  </div>

  <section id="ram-results">
    <div class="kalki-post-container"></div>
  </section>

  <script>
    let ramPostsData = [];
    const postContainer = document.querySelector(".kalki-post-container");

    fetch("https://raw.githubusercontent.com/Morningstar88/kalki-search/master/myla.txt")
      .then(response => response.json())
      .then(data => {
        ramPostsData = data;
        displayPosts(ramPostsData);
      })
      .catch(error => console.error("Error fetching RAM data:", error));

    const displayPosts = (posts) => {
      postContainer.innerHTML = "";
      posts.forEach(post => {
        const { title, link, image, categories } = post;
        const postElement = document.createElement("div");
        postElement.classList.add("kalki-post");
        postElement.innerHTML = `
          <a href="${link}" target="_blank">
            <img src="${image}" alt="${title}" loading="lazy" />
          </a>
          <div class="post-content">
            <div class="post-title">${title}</div>
            <div>
              ${categories.map(cat => `<span class="post-tag">${cat}</span>`).join("")}
            </div>
          </div>
        `;
        postContainer.appendChild(postElement);
      });
    };

    document.getElementById("search-box").addEventListener("input", () => {
      const query = document.getElementById("search-box").value.trim();
      if (query) {
        const filteredPosts = ramPostsData.filter(post =>
          post.title.toLowerCase().includes(query.toLowerCase()) ||
          post.categories.some(cat => cat.toLowerCase().includes(query.toLowerCase()))
        );
        displayPosts(filteredPosts);
      } else {
        displayPosts(ramPostsData);
      }
    });
  </script>
</body>
</html>

